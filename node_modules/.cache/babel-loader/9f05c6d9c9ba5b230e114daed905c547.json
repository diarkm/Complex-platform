{"ast":null,"code":"import _regeneratorRuntime from\"D:\\\\Work\\\\Projects\\\\GIQ\\\\giq.itgeek.kz\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"D:\\\\Work\\\\Projects\\\\GIQ\\\\giq.itgeek.kz\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"D:\\\\Work\\\\Projects\\\\GIQ\\\\giq.itgeek.kz\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import _objectWithoutProperties from\"D:\\\\Work\\\\Projects\\\\GIQ\\\\giq.itgeek.kz\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectWithoutProperties\";import React,{useState,useEffect,useContext}from\"react\";import createAuth0Client from\"@auth0/auth0-spa-js\";var DEFAULT_REDIRECT_CALLBACK=function DEFAULT_REDIRECT_CALLBACK(){return window.history.replaceState({},document.title,window.location.pathname);};export var Auth0Context=React.createContext();export var useAuth0=function useAuth0(){return useContext(Auth0Context);};export var Auth0Provider=function Auth0Provider(_ref){var children=_ref.children,_ref$onRedirectCallba=_ref.onRedirectCallback,onRedirectCallback=_ref$onRedirectCallba===void 0?DEFAULT_REDIRECT_CALLBACK:_ref$onRedirectCallba,initOptions=_objectWithoutProperties(_ref,[\"children\",\"onRedirectCallback\"]);var _useState=useState(),_useState2=_slicedToArray(_useState,2),isAuthenticated=_useState2[0],setIsAuthenticated=_useState2[1];var _useState3=useState(),_useState4=_slicedToArray(_useState3,2),user=_useState4[0],setUser=_useState4[1];var _useState5=useState(),_useState6=_slicedToArray(_useState5,2),auth0Client=_useState6[0],setAuth0=_useState6[1];var _useState7=useState(true),_useState8=_slicedToArray(_useState7,2),loading=_useState8[0],setLoading=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,1),popupOpen=_useState10[0];useEffect(function(){var initAuth0=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var auth0FromHook,_yield$auth0FromHook$,appState,isAuthenticated,_user;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return createAuth0Client(initOptions);case 2:auth0FromHook=_context.sent;setAuth0(auth0FromHook);if(!window.location.search.includes(\"code=\")){_context.next=10;break;}_context.next=7;return auth0FromHook.handleRedirectCallback();case 7:_yield$auth0FromHook$=_context.sent;appState=_yield$auth0FromHook$.appState;onRedirectCallback(appState);case 10:_context.next=12;return auth0FromHook.isAuthenticated();case 12:isAuthenticated=_context.sent;setIsAuthenticated(isAuthenticated);if(!isAuthenticated){_context.next=19;break;}_context.next=17;return auth0FromHook.getUser();case 17:_user=_context.sent;setUser(_user);case 19:setLoading(false);case 20:case\"end\":return _context.stop();}}},_callee);}));return function initAuth0(){return _ref2.apply(this,arguments);};}();initAuth0();// eslint-disable-next-line\n},[]);var handleRedirectCallback=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var user;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:setLoading(true);_context2.next=3;return auth0Client.handleRedirectCallback();case 3:_context2.next=5;return auth0Client.getUser();case 5:user=_context2.sent;setLoading(false);setIsAuthenticated(true);setUser(user);case 9:case\"end\":return _context2.stop();}}},_callee2);}));return function handleRedirectCallback(){return _ref3.apply(this,arguments);};}();return/*#__PURE__*/React.createElement(Auth0Context.Provider,{value:{isAuthenticated:isAuthenticated,user:user,loading:loading,popupOpen:popupOpen,handleRedirectCallback:handleRedirectCallback,auth0Client:auth0Client,getIdTokenClaims:function getIdTokenClaims(){return auth0Client.getIdTokenClaims.apply(auth0Client,arguments);},loginWithRedirect:function loginWithRedirect(){return auth0Client.loginWithRedirect.apply(auth0Client,arguments);},getTokenSilently:function getTokenSilently(){return auth0Client.getTokenSilently.apply(auth0Client,arguments);},getTokenWithPopup:function getTokenWithPopup(){return auth0Client.getTokenWithPopup.apply(auth0Client,arguments);},logout:function logout(){return auth0Client.logout.apply(auth0Client,arguments);}}},children);};","map":{"version":3,"sources":["D:/Work/Projects/GIQ/giq.itgeek.kz/src/authServices/auth0/auth0Service.js"],"names":["React","useState","useEffect","useContext","createAuth0Client","DEFAULT_REDIRECT_CALLBACK","window","history","replaceState","document","title","location","pathname","Auth0Context","createContext","useAuth0","Auth0Provider","children","onRedirectCallback","initOptions","isAuthenticated","setIsAuthenticated","user","setUser","auth0Client","setAuth0","loading","setLoading","popupOpen","initAuth0","auth0FromHook","search","includes","handleRedirectCallback","appState","getUser","getIdTokenClaims","loginWithRedirect","getTokenSilently","getTokenWithPopup","logout"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useContext } from \"react\"\nimport createAuth0Client from \"@auth0/auth0-spa-js\"\n\nconst DEFAULT_REDIRECT_CALLBACK = () =>\n  window.history.replaceState({}, document.title, window.location.pathname)\n\nexport const Auth0Context = React.createContext()\nexport const useAuth0 = () => useContext(Auth0Context)\nexport const Auth0Provider = ({\n  children,\n  onRedirectCallback = DEFAULT_REDIRECT_CALLBACK,\n  ...initOptions\n}) => {\n  const [isAuthenticated, setIsAuthenticated] = useState()\n  const [user, setUser] = useState()\n  const [auth0Client, setAuth0] = useState()\n  const [loading, setLoading] = useState(true)\n  const [popupOpen] = useState(false)\n\n  useEffect(() => {\n    const initAuth0 = async () => {\n      const auth0FromHook = await createAuth0Client(initOptions)\n      setAuth0(auth0FromHook)\n\n      if (window.location.search.includes(\"code=\")) {\n        const { appState } = await auth0FromHook.handleRedirectCallback()\n        onRedirectCallback(appState)\n      }\n\n      const isAuthenticated = await auth0FromHook.isAuthenticated()\n\n      setIsAuthenticated(isAuthenticated)\n\n      if (isAuthenticated) {\n        const user = await auth0FromHook.getUser()\n        setUser(user)\n      }\n\n      setLoading(false)\n    }\n    initAuth0()\n    // eslint-disable-next-line\n  }, [])\n\n  const handleRedirectCallback = async () => {\n    setLoading(true)\n    await auth0Client.handleRedirectCallback()\n    const user = await auth0Client.getUser()\n    setLoading(false)\n    setIsAuthenticated(true)\n    setUser(user)\n  }\n  return (\n    <Auth0Context.Provider\n      value={{\n        isAuthenticated,\n        user,\n        loading,\n        popupOpen,\n        handleRedirectCallback,\n        auth0Client,\n        getIdTokenClaims: (...p) => auth0Client.getIdTokenClaims(...p),\n        loginWithRedirect: (...p) => auth0Client.loginWithRedirect(...p),\n        getTokenSilently: (...p) => auth0Client.getTokenSilently(...p),\n        getTokenWithPopup: (...p) => auth0Client.getTokenWithPopup(...p),\n        logout: (...p) => auth0Client.logout(...p)\n      }}\n    >\n      {children}\n    </Auth0Context.Provider>\n  )\n}\n"]},"metadata":{},"sourceType":"module"}